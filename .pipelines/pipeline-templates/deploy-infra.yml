  parameters:
  - name: templateFilePath
    type: string
  - name: templateFilePath
    type: string
  - name: appName
    type: string
  
  jobs:
  - job: DeployARM
    dependsOn: CreateResourceGroup
    displayName: Deploy ARM template
    steps:
    - task: AzureResourceManagerTemplateDeployment@3
      displayName: Deploy ARM Template
      inputs:
        connectedServiceName: $(ServiceConnectionName)
        deploymentName: $(Build.BuildNumber)
        location: $(deploymentDefaultLocation)
        resourceGroupName: $(ResourceGroupName)
        csmFile: $(Pipeline.Workspace)/Bicep/main.json
        csmParametersFile: ${{ parameters.templateParameterFilePath }}}
        overrideParameters: -appName $(appName)