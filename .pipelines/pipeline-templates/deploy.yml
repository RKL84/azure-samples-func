  jobs:
  - job: DeployARM
    displayName: Deploy ARM template
    steps:
    - task: AzureResourceManagerTemplateDeployment@3
      displayName: Deploy ARM Template
      inputs:
        connectedServiceName: $(ServiceConnectionName)
        deploymentName: $(Build.BuildNumber)
        location: $(deploymentDefaultLocation)
        resourceGroupName: $(ResourceGroupName)
        csmFile: deploy/main.bicep
        csmParametersFile: deploy/parameters.dev.json
        overrideParameters: -appName $(appName)

  # - deployment: Deploy
  #   dependsOn: DeployARM
  #   displayName: Upload Code
  #   pool:
  #     vmImage: 'ubuntu-20.04'
  #   condition: succeeded()
  #   environment: dev
  #   variables:
  #   - group: Release
  #   strategy:
  #     runOnce:
  #       deploy:
  #         steps:
  #         - download: current
  #           artifact: FunctionApp
  #         - task: AzureFunctionApp@1
  #           displayName: 'Azure App Service Deploy: function'
  #           inputs:
  #             azureSubscription: $(ServiceConnectionName)
  #             appName: func-$(appName)-dev
  #             appType: 'functionApp'
  #             package: '$(Pipeline.Workspace)/FunctionApp/$(buildConfiguration)/*.zip'
  #             deploymentMethod: 'zipDeploy' 